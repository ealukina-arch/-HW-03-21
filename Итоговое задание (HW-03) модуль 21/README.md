NewsPortal - Новостной портал на Django с функциями регистрации пользователей, созданием новостей и статей, подпиской на категории и автоматической email-рассылкой.

Реализованные требования итогового задания:
1. Подписка на категории: Пользователи могут подписываться на рассылку новых статей в выбранной категории.
2. Мгновенные уведомления о новых статьях: Когда в категорию добавляется новая статья, всем подписчикам этой категории отправляется email с:
-Кратким содержанием статьи
-Гиперссылкой на полный текст статьи
3. Еженедельная рассылка: Каждую неделю подписчикам категории отправляется email со списком новых статей за неделю. Каждая статья содержит:
-Название статьи
-Гиперссылку для перехода к полному тексту
4. Приветственное письмо при регистрации: При регистрации нового пользователя автоматически отправляется приветственное письмо на указанный email.

Установка и настройка
1. Клонирование репозитория

git clone <ссылка-на-репозиторий>
cd newsportal

2. Создание виртуального окружения

python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

3. Установка зависимостей

pip install -r requirements.txt

4. Настройка базы данных

python manage.py makemigrations
python manage.py migrate

5. Создание суперпользователя

python manage.py createsuperuser

6. Настройка email в settings.py

Для продакшена (реальная отправка писем):

EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = 'smtp.gmail.com'
EMAIL_PORT = 587
EMAIL_USE_TLS = True
EMAIL_HOST_USER = 'your-email@gmail.com'
EMAIL_HOST_PASSWORD = 'your-app-password'
DEFAULT_FROM_EMAIL = 'your-email@gmail.com'

Для разработки (письма выводятся в консоль):

EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'

7. Запуск сервера

python manage.py runserver
Приложение будет доступно по адресу: http://127.0.0.1:8000

Где найти функции подписки
Подписка на категорию

Способ 1: Через страницу категории

1.1.Перейдите на главную страницу новостей:
http://127.0.0.1:8000/news/
1.2.Кликните на любую категорию в списке новостей
1.3.На странице категории найдите кнопку "Подписаться"
1.4.После нажатия вы будете подписаны на получение:
  -Мгновенных уведомлений о новых статьях
  -Еженедельных дайджестов

Способ 2: Прямой URL

http://127.0.0.1:8000/category/<id>/
Где <id> - номер категории (например, 1, 2, 3)

Управление подписками
2.1.Перейдите на страницу управления подписками:
http://127.0.0.1:8000/my-subscriptions/
2.2.Здесь отображаются все ваши активные подписки
2.3.Для отписки нажмите кнопку "Отписаться" рядом с нужной категорией

Как тестировать рассылки
Требование 1: Приветственное письмо при регистрации
Что тестируем: Приветственное письмо должно отправляться при регистрации нового пользователя.

Шаги тестирования:
1.Откройте страницу регистрации:
http://127.0.0.1:8000/accounts/signup/
2.Заполните форму регистрации:
  -Имя пользователя
  -Email (укажите реальный email)
  -Пароль
3.Нажмите кнопку "Зарегистрироваться"
4.Проверьте почту (или консоль, если используется console backend)

Ожидаемый результат:
-Письмо с темой "Добро пожаловать в News Portal"
-Содержит приветственное сообщение
-Отправлено на указанный при регистрации email

Требование 2: Мгновенное уведомление о новой статье
Что тестируем: При добавлении новой статьи в категорию, подписчики получают email с кратким содержанием и гиперссылкой на статью.

Предварительные условия:
-Вы зарегистрированы и авторизованы
-Вы подписаны на категорию (например, "Технологии")
-У вас есть права автора для создания статей

Шаги тестирования:
1.Войдите в систему как автор или суперпользователь
2.Перейдите на страницу создания статьи:

http://127.0.0.1:8000/articles/create/
или
http://127.0.0.1:8000/news/create/
3.Заполните форму:
-Заголовок статьи
-Содержание статьи
-Выберите категорию, на которую подписаны пользователи
-Выберите тип "Статья" (Article)
4.Нажмите кнопку "Создать"
5.Проверьте почту подписчиков этой категории (или консоль)

Ожидаемый результат:
-Письмо с темой "Новая статья в категории [Название категории]"
-Содержит краткое содержание статьи (первые 50-100 символов)
-Содержит гиперссылку на полный текст: http://127.0.0.1:8000/news/<id>/
-Письмо отправлено всем подписчикам выбранной категории

Требование 3: Еженедельная рассылка
Что тестируем: Каждую неделю подписчики получают список новых статей за неделю с гиперссылками.

Предварительные условия:
-В базе данных есть статьи, созданные за последние 7 дней
-Пользователи подписаны на категории этих статей

Шаги для ручного тестирования:
1.Создайте несколько статей в разных категориях за последние 7 дней (если их нет)
2.Убедитесь, что есть подписчики на эти категории
3.Откройте терминал в корневой директории проекта
4. Выполните management-команду:
python manage.py send_weekly_digest
5.Проверьте почту подписчиков (или консоль)

Ожидаемый результат:
-Письмо с темой "Еженедельный дайджест новостей"
-Содержит список новых статей за последние 7 дней в подписанных категориях
-Для каждой статьи указан:
-Заголовок статьи
-Гиперссылка на полный текст: http://127.0.0.1:8000/news/<id>/
-Если новых статей за неделю нет, письмо не отправляется
-Письмо отправляется только подписчикам соответствующих категорий

Настройка автоматической еженедельной рассылки
Для автоматической отправки еженедельных дайджестов используйте планировщик задач.

Windows (Планировщик заданий):
1.Откройте "Планировщик заданий" (Task Scheduler)
2.Создайте новое задание:
  -Действие: Запустить программу
  -Программа: python
  -Аргументы: manage.py send_weekly_digest
  -Рабочая папка: путь к папке проекта
  -Триггер: Еженедельно, каждую пятницу в 18:00

Основные URL маршруты
text
/                              - главная страница со списком новостей
/news/                         - список всех новостей
/news/<id>/                    - просмотр отдельной новости/статьи
/news/create/                  - создание новости
/articles/create/              - создание статьи
/category/<id>/                - список статей категории + кнопка подписки
/category/<id>/subscribe/      - подписаться на категорию
/category/<id>/unsubscribe/    - отписаться от категории
/my-subscriptions/             - управление подписками
/accounts/signup/              - регистрация
/accounts/login/               - вход в систему
/accounts/logout/              - выход из системы
/admin/                        - административная панель
Структура проекта
text
newsportal/
├── news/                           # основное приложение
│   ├── management/
│   │   └── commands/
│   │       └── send_weekly_digest.py    # команда еженедельной рассылки
│   ├── templates/
│   │   ├── account/
│   │   │   ├── login.html
│   │   │   └── signup.html
│   │   ├── emails/                      # шаблоны писем
│   │   │   ├── welcome_email.html       # приветственное письмо
│   │   │   ├── new_article_notification.html  # уведомление о статье
│   │   │   └── weekly_digest.html       # еженедельный дайджест
│   │   └── news/
│   │       ├── news_list.html
│   │       ├── news_detail.html
│   │       ├── category_posts.html      # страница категории с подпиской
│   │       └── my_subscriptions.html    # управление подписками
│   ├── models.py                        # модели (Post, Category, Subscription)
│   ├── views.py                         # представления
│   ├── signals.py                       # сигналы для email-рассылок
│   ├── urls.py                          # маршруты
│   └── services/
│       └── email_service.py             # сервис отправки писем
├── manage.py
└── requirements.txt

Модели данных
Category (Категория)

class Category(models.Model):
    name = CharField()              # Название категории

Post (Новость/Статья)
class Post(models.Model):
    title = CharField()             # Заголовок
    content = TextField()           # Содержание
    author = ForeignKey(User)       # Автор
    category = ForeignKey(Category) # Категория
    post_type = CharField()         # Тип: новость или статья
    created_at = DateTimeField()    # Дата создания

Subscription (Подписка)
class Subscription(models.Model):
    user = ForeignKey(User)         # Пользователь
    category = ForeignKey(Category) # Категория
    subscribed_at = DateTimeField() # Дата подписки

Система email-уведомлений
Реализованные типы писем
1. Приветственное письмо (требование 4)
-Отправляется при регистрации нового пользователя
-Шаблон: templates/emails/welcome_email.html
-Тема: "Добро пожаловать в News Portal"

2. Уведомление о новой статье (требование 2)
-Отправляется подписчикам категории при создании новой статьи
-Шаблон: templates/emails/new_article_notification.html
-Содержит: краткое содержание + гиперссылка на статью
-Тема: "Новая статья в категории [Название]"

3. Еженедельный дайджест (требование 3)
-Отправляется раз в неделю с помощью команды send_weekly_digest
-Шаблон: templates/emails/weekly_digest.html
-Содержит: список новых статей за неделю с гиперссылками
-Тема: "Еженедельный дайджест новостей"

Автоматическая отправка
Письма отправляются автоматически с помощью сигналов Django:
-post_save - для приветственных писем и уведомлений о статьях
-Management-команда - для еженедельных дайджестов

Тестирование в режиме разработки
Для тестирования без реальной отправки писем используйте консольный backend в settings.py:

EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'

При таком режиме все письма будут выводиться в консоль терминала, где запущен сервер Django. Вы увидите:
-Тему письма
-Содержимое письма
-Получателей
Это позволяет тестировать все функции рассылки без настройки SMTP-сервера.

Устранение неполадок
Письма не отправляются
Проверьте:
1.Настройки EMAIL в settings.py корректны
2.Для Gmail используется "пароль приложения", а не обычный пароль
3.В консоли сервера нет ошибок при отправке
4.Пользователь указал email при регистрации
5.Для отладки используйте EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'

Еженедельная рассылка не работает
Проверьте:
1.В базе данных есть статьи, созданные за последние 7 дней
2.Пользователи подписаны на категории этих статей
3.Запустите команду вручную для проверки:
python manage.py send_weekly_digest
4.Проверьте вывод в консоли на наличие ошибок

Подписка не сохраняется
Проверьте:
1.Вы авторизованы в системе
2.Применены все миграции: python manage.py migrate
3.В консоли сервера нет ошибок при подписке
4.Проверьте в админке наличие подписки: http://127.0.0.1:8000/admin/

Уведомления о новых статьях не приходят
Проверьте:
1.Тип поста установлен как "Статья" (Article), а не "Новость" (News)
2.Есть подписчики на выбранную категорию
3.Email пользователей корректно указан в их профилях
4.Проверьте логи в консоли на наличие ошибок

Соответствие требованиям ТЗ
Требование 1: Подписка на рассылку
Статус: Реализовано

Страница категории с кнопкой "Подписаться"

Страница управления подписками

URL: /category/<id>/subscribe/

Требование 2: Мгновенные уведомления
Статус: Реализовано

Автоматическая отправка при создании статьи

Краткое содержание статьи в письме

Гиперссылка на полный текст статьи

Отправка только подписчикам категории

Требование 3: Еженедельная рассылка
Статус: Реализовано

Management-команда send_weekly_digest

Список статей за последние 7 дней

Гиперссылки на каждую статью

Отправка только подписчикам соответствующих категорий

Требование 4: Приветственное письмо
Статус: Реализовано

Автоматическая отправка при регистрации

Отправка на email, указанный при регистрации

Дополнительная функциональность
Помимо обязательных требований, реализовано:

-Административная панель для управления контентом
-Система комментариев к статьям
-Поиск и фильтрация новостей
-Разделение на новости и статьи
-Адаптивный дизайн интерфейса
